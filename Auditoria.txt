**AUDITORÍA DEL SISTEMA GPSpedia v2.0**

**FECHA DE AUDITORÍA:** 2024-07-30

**AUDITOR:** Jules

---

### **INCIDENTE: Refactorización de Arquitectura Frontend para Centralizar la Configuración de Endpoints**

**1. RESUMEN DEL INCIDENTE:**
   - Tras una actualización de endpoints, se identificó un problema de arquitectura crítico: la configuración de los endpoints de los microservicios estaba duplicada en dos archivos (`api.js` y `api-manager.js`).
   - Esta duplicación era una fuente de errores, inconsistencias y deuda técnica, dificultando el mantenimiento de la aplicación.
   - Se tomó la decisión de refactorizar el frontend para establecer una **única fuente de verdad** para toda la configuración de la API.

**2. ANÁLISIS Y HALLAZGOS:**
   - **Causa Raíz:** La aplicación había evolucionado de forma incremental, con `index.html` utilizando `api-manager.js` como un script global, mientras que páginas más nuevas como `users.html` utilizaban `api.js` como un módulo de JavaScript (`import`). Ambos archivos contenían copias idénticas de las mismas constantes de configuración.
   - **Riesgo:** Cualquier actualización de URL que no se aplicara en ambos archivos resultaría en un fallo parcial de la aplicación.

**3. ACCIONES CORRECTIVAS REALIZADAS (Refactorización):**
   1.  **Creación de `api-config.js`:** Se creó un nuevo archivo que ahora contiene y exporta las constantes `API_ENDPOINTS` y `ACTION_TO_SERVICE_MAP`, sirviendo como la única fuente de verdad.
   2.  **Refactorización de `api.js`:** Se modificó para que importe su configuración directamente desde `api-config.js`, eliminando las constantes locales.
   3.  **Refactorización y Eliminación de `api-manager.js`:** Se refactorizó `api-manager.js` de la misma manera. Tras un análisis más profundo, se determinó que su funcionalidad era completamente redundante con respecto a `api.js`. Por lo tanto, el archivo `api-manager.js` fue **eliminado** del proyecto.
   4.  **Ajuste de `main.js`:** Se revisó y ajustó el punto de entrada principal, `main.js`, para asegurar que importa y utiliza correctamente la lógica del refactorizado `api.js`, y que expone las funciones necesarias al ámbito global para la compatibilidad con el HTML.

**4. ESTADO:**
   - **COMPLETADO:** La refactorización ha sido completada con éxito. La configuración de la API ahora está centralizada en `api-config.js`, eliminando la duplicación y el riesgo de inconsistencia. El código del frontend es ahora más limpio, más mantenible y sigue un patrón de diseño modular consistente.
