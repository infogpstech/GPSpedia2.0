---
**TAREAS PENDIENTES DE REVISIÓN**
---
1. **TÍTULO: Corrección Definitiva de Fallos en Búsqueda y Modal**
   - **ESTADO:** PENDIENTE DE REVISIÓN POR EL PM
   - **TIPO:** Corrección de Causa Raíz / Bug Visual de CSS / Race Condition / Refactor de Inicialización
   - **ALCANCE:** Se implementaron correcciones definitivas en `style.css`, `ui.js` y `auth.js`.
   - **DESCRIPCIÓN DETALLADA:**
     - **Problema Espaciado (Causa Raíz: Efecto Aditivo de CSS):** Se corrigió el espaciado de la barra de búsqueda en `style.css` anulando explícitamente el `padding-bottom` heredado en la regla `body.search-active .container`.
     - **Problema Video (Causa Raíz: Race Condition):** Se solucionó la no visualización del video en `ui.js` refactorizando el `event listener` del acordeón para usar `setTimeout(..., 0)`, lo que resuelve la condición de carrera al calcular la altura del panel.
     - **Problema de Renderizado (Causa Raíz: Race Condition de Inicialización):** Se refactorizó el flujo de inicialización en `auth.js` para asegurar que `showApp()` (y por tanto, el renderizado de la UI) se ejecute solo después de que los datos del catálogo hayan sido cargados exitosamente.

---
**TAREAS COMPLETADAS (Validadas por el PM)**
---
1. MEJORA Y REFINAMIENTO DE ANIMACIÓN DE BÚSQUEDA
Estado: COMPLETADO
Origen: Refinamiento UX
Prioridad: Normal
Área: Frontend | UI | CSS | JS
Archivos involucrados: style.css, main.js

Descripción:
Se completó un ciclo de mejoras en la animación de la barra de búsqueda. Las implementaciones incluyen:
- La adición de la animación de expansión/contracción de la barra al hacer foco, replicando el comportamiento de la v1.5.
- La ocultación del menú de hamburguesa y la reducción del espacio superior para optimizar la vista de búsqueda.
- La corrección final y definitiva del espaciado vertical entre la barra y los resultados, asegurando una alineación perfecta.

2. INVESTIGAR CIERRE DE SESIÓN INESPERADO TRAS REFRESH
Estado: COMPLETADO
Origen: Reporte de Bug
Prioridad: CRÍTICA
Área: Frontend | Autenticación | Estado
Archivos involucrados: auth.js

Descripción:
Se ha implementado una corrección para prevenir una condición de carrera (`race condition`) durante la validación de la sesión. Se añadió un mecanismo de bloqueo (`lock`) en `localStorage` para asegurar que solo una pestaña o proceso de validación se comunique con el backend a la vez, evitando que validaciones concurrentes se invaliden entre sí.

3. CORRECCIÓN DEL SISTEMA DE BÚSQUEDA Y NAVEGACIÓN
Estado: COMPLETADO
Origen: Múltiples reportes de bugs y regresiones.
Prioridad: CRÍTICA
Área: Frontend | Navegación | Búsqueda | UX
Archivos involucrados: ui.js, navigation.js

Descripción:
Se completó un ciclo de correcciones que abordaron múltiples fallos en el sistema de búsqueda y su navegación subsecuente. Las correcciones incluyen:
- Asegurar que la búsqueda por modelo muestre tarjetas de modelo en lugar de logos de marca.
- Corregir el flujo de navegación para que, después de una búsqueda, se avance correctamente en la jerarquía de selección (Año, etc.).
- Eliminar una regresión que causaba la de-duplicación incorrecta de resultados.
- Corregir un `SyntaxError` fatal que impedía la carga de la aplicación.
- Implementar la corrección definitiva para el botón "Regresar", asegurando que devuelva al usuario a los resultados de la búsqueda de manera consistente, mediante el manejo correcto del estado de navegación anidado.

---
**REGISTRO DE TAREAS — BACKLOG ACTIVO**
---
*En este momento no hay tareas activas en el backlog.*

---
NORMAS OBLIGATORIAS DE DESARROLLO
---------------------------------

**A. Control de Versiones y Documentación:**
1.  **Actualización de Versión:** Cualquier cambio debe reflejarse en el número de versión visible en `index.html` y en los servicios de Apps Script.
2.  **Consulta y Actualización de Documentación:** Antes y después de cualquier desarrollo, se deben consultar y actualizar `README.md`, `Instrucciones.txt` y `ChangesLogs.txt`.
3.  **Detalle en `ChangesLogs.txt`:** Cada entrada debe especificar el archivo y número de línea modificado.

**B. Calidad del Código:**
1.  **Comentarios:** Todo código nuevo o modificado debe tener un comentario explicando su propósito.
2. **prohibido eliminar el bloque que describe mas reglas en Instrucciones.txt
3.**prohibido resumir o utilizar sumarizacion "(Sin Cambios)" EN NINGUN ARCHIVO DE CODIGO, DOCUMENTACIÓN O DE REGLAMENTO.
4. PROHIBIDO REVERTIR COMMITS SIN LA SOLICITUD DEL PM.
5. PROHIBIDO USAR HERRAMIENTAS BUSQUEDA, EDICION RAPIDA, TODA BUSQUEDA, REVISION DEBE SER LINEA POR LINEA DE ARCHIVO POR ARCHIVO.
6. OBLIGATORIO AUDITAR CADA ARCHIVO DE CODIGO ANTES DE CUALQUER MODIFICacion POR MUY PEQUEÑA QUE SEA CADA HALLAZGO NO DEBE SER REPARADO EN EL MOMENTO DE AUDITORIA, DEBE DE REGISTRARSE EN Auditoria.txt Y DESPUES PLANTEARSE COMO UNA NUEVA TAREA EN Instrucciones.txt.
7. PROHIBIDO DUPLICAR BLOQUES DE CODIGO, POR ELLO ES LA AUDITORIA INICIAL.
8. PROHIBIDO INVENTARSE LA FECHA EN ChangesLogs.txt USAR DE REFERENCIA LA FECHA DE LA ULTIMA ENTRADA DE ChangesLogs.txt
9. No asumir que cualquier fix registrado en ChangesLogs.txt fue exitoso.
10. NO registrar como EXITO Cualquier Fix aplicado en el codigo, toda entrada debe evitar asumir arreglar fallas y evitar utilizar terminos como "Se corrigio, se arreglo,..etc"

**C. Proceso de Aprobación:**
1.  **PROHIBIDO marcar tareas como “completadas” sin revisión del Project Manager.**
2.  **PROHIBIDO asumir que un cambio resolvió un problema.**
3.  **SOLO describir qué se cambió o qué se debe cambiar.**
4.  Si una tarea introduce nuevos errores: Marcar como **EN REVISIÓN**.
5.  Si la tarea no funciona o no cumple: REQUIERE **NUEVA REVISIÓN**.
6. si una tarea se realizo no marcarla como COMPLETADA, marcarla como PENDIENTE REVISION POR EL MP.


PROCESO ESTÁNDAR DE TRABAJO
===========================================================

Este protocolo define los PASOS OBLIGATORIOS que todo desarrollador debe
seguir en TODOS los proyectos, sin excepción.


FLUJO OBLIGATORIO DE TRABAJO
----------------------------

1. AUDITORÍA INICIAL DEL ARCHIVO
   - Auditar el archivo o archivos involucrados en la tarea.
   - La auditoría DEBE realizarse:
     - Archivo por archivo
     - Línea por línea
   - NO modificar código durante esta fase.

2. REGISTRO DE HALLAZGO
   - Registrar TODOS los hallazgos en Auditoria.txt.
   - Crear una nueva entrada para el archivo auditado.
   - Si ya existe una auditoría previa del mismo archivo:
     -> Actualizar la entrada existente
     -> NO eliminar información previa.

3. HALLAZGO FUERA DE la TAREA ORIGINAL
   - Si se detectan problemas NO relacionados directamente
     con la tarea asignada:
     a) Resolverlos en el MISMO commit de la tarea,
        SOLO si es técnicamente posible y seguro.
     b) Si NO es posible resolverlos:
        -> Registrar la nueva tarea en Instrucciones.txt
        -> Agregar referencia al hallazgo en Auditoría.txt

4. EJECUCIÓN DE la TAREA
   - Realizar ÚNICAMENTE los cambios solicitados por la tarea
     sobre el código.
   - Respetar todas las normas definidas en Instrucciones.txt.

5. VERIFICACIÓN FUNCIONAL
   - Verificar que los cambios realizados:
     - Cumplen el objetivo de la tarea
     - NO rompen otras funciones del archivo
     - NO afectan flujos de información existentes

6. VERIFICACIÓN COMPLEMENTARIA
   - Revisar:
     - Dependencias
     - Funciones relacionadas
     - Llamadas internas o externas
   - Confirmar que no se introdujeron efectos colaterales.

7. REVISIÓN FINAL DEL CÓDIGO
   - Revisar nuevamente el archivo completo modificado:
     - Línea por línea
     - Función por función
   - Validar coherencia, legibilidad y cumplimiento de reglas.

8. REGISTRO EN CHANGESLOGS.TXT
   - Registrar los cambios realizados indicando:
     - Archivo(s) modificado(s)
     - Línea(s) afectada(s)
     - Descripción objetiva del cambio
   - NO asumir éxito
   - NO usar términos como:
     - "Se corrigió"
     - "Se arregló"
     - "Se solucionó"

9. ACTUALIZACIÓN DE INSTRUCCIONES.TXT
   - Mover la tarea ejecutada al bloque:
     -> "TAREAS PENDIENTES DE REVISIÓN"
   - NO marcar la tarea como completada.

10. COMMIT
    - Realizar el commit SOLO después de cumplir
      todos los pasos anteriores.
    - El commit debe reflejar EXACTAMENTE
      - Lo documentado en ChangesLogs.txt
      - El estado actualizado de Instrucciones.txt


REGLA FINAL
-----------
Si un paso NO fue ejecutado, el proceso se considera INCOMPLETO.
NO se permiten atajos, omisiones ni reinterpretaciones.
