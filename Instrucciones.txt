NORMAS OBLIGATORIAS DE DESARROLLO
---------------------------------

**A. Control de Versiones y Documentación:**
1.  **Actualización de Versión:** Cualquier cambio debe reflejarse en el número de versión visible en `index.html` y en los servicios de Apps Script.
2.  **Consulta y Actualización de Documentación:** Antes y después de cualquier desarrollo, se deben consultar y actualizar `README.md`, `Instrucciones.txt` y `ChangesLogs.txt`.
3.  **Detalle en `ChangesLogs.txt`:** Cada entrada debe especificar el archivo y número de línea modificado.

**B. Calidad del Código:**
1.  **Comentarios:** Todo código nuevo o modificado debe tener un comentario explicando su propósito.
2. **prohibido eliminar el bloque que describe mas reglas en Instrucciones.txt
3.**prohibido resumir o utilizar sumarizacion "(Sin Cambios)" EN NINGUN ARCHIVO DE CODIGO, DOCUMENTACIÓN O DE REGLAMENTO.
4. PROHIBIDO REVERTIR COMMITS SIN LA SOLICITUD DEL PM.
5. PROHIBIDO USAR HERRAMIENTAS BUSQUEDA, EDICION RAPIDA, TODA BUSQUESA, REVISION DEBE SER LINEA POR LINEA DE ARCHIVO POR ARCHIVO.
6. OBLIGATORIO AUDITAR CADA ARCHIVO DE CODIGO ANTES DE CUALQUIER MODIFICACION POR MUY PEQUEÑA QUE SEA CADA HALLAZGO NO DEBE SER REPARADO EN EL MOMENTO DE AUDITORIA, DEBE DE REGISTRARSE EN Auditoria.txt Y DESPUES PLANTEARSE COMO UNA NUEVA TAREA EN Instrucciones.txt.
7. PROHIBIDO DUPLICAR BLOQUES DE CODIGO, POR ELLO ES LA AUDITORIA INICIAL.
8. PROHIBIDO INVENTARSE LA FECHA EN ChangesLogs.txt USAR DE REFERENCIA LA FECHA DE LA ULTIMA ENTRADA DE ChangesLogs.txt
9. No asumir que cualquier fix registrado en ChangesLogs.txt fue exitoso.
10. NO registrar como EXITO Cualquier Fix aplicado en el codigo, toda entrada debe evitar asumir arreglar fallas y evitar utilizar terminos como "Se corrigio, se arreglo,..etc"

**C. Proceso de Aprobación:**
1.  **PROHIBIDO marcar tareas como “completadas” sin revisión del Project Manager.**
2.  **PROHIBIDO asumir que un cambio resolvió un problema.**
3.  **SOLO describir qué se cambió o qué se debe cambiar.**
4.  Si una tarea introduce nuevos errores: Marcar como **EN REVISIÓN**.
5.  Si la tarea no funciona o no cumple: REQUIERE **NUEVA REVISIÓN**.
6. si una tarea se realizo no marcarla como COMPLETADA, marcarla como PENDIENTE REVISION POR EL MP.


PROCESO ESTÁNDAR DE TRABAJO
===========================================================

Este protocolo define los PASOS OBLIGATORIOS que todo desarrollador debe
seguir en TODOS los proyectos, sin excepción.


FLUJO OBLIGATORIO DE TRABAJO
----------------------------

1. AUDITORÍA INICIAL DEL ARCHIVO
   - Auditar el archivo o archivos involucrados en la tarea.
   - La auditoría DEBE realizarse:
     - Archivo por archivo
     - Línea por línea
   - NO modificar código durante esta fase.

2. REGISTRO DE HALLAZGO
   - Registrar TODOS los hallazgos en Auditoría.txt.
   - Crear una nueva entrada para el archivo auditado.
   - Si ya existe una auditoría previa del mismo archivo:
     -> Actualizar la entrada existente
     -> NO eliminar información previa.

3. HALLAZGO FUERA DE la TAREA ORIGINAL
   - Si se detectan problemas NO relacionados directamente
     con la tarea asignada:
     a) Resolverlos en el MISMO commit de la tarea,
        SOLO si es técnicamente posible y seguro.
     b) Si NO es posible resolverlos:
        -> Registrar la nueva tarea en Instrucciones.txt
        -> Agregar referencia al hallazgo en Auditoría.txt

4. EJECUCIÓN DE la TAREA
   - Realizar ÚNICAMENTE los cambios solicitados por la tarea
     sobre el código.
   - Respetar todas las normas definidas en Instrucciones.txt.

5. VERIFICACIÓN FUNCIONAL
   - Verificar que los cambios realizados:
     - Cumplen el objetivo de la tarea
     - NO rompen otras funciones del archivo
     - NO afectan flujos de información existentes

6. VERIFICACIÓN COMPLEMENTARIA
   - Revisar:
     - Dependencias
     - Funciones relacionadas
     - Llamadas internas o externas
   - Confirmar que no se introdujeron efectos colaterales.

7. REVISIÓN FINAL DEL CÓDIGO
   - Revisar nuevamente el archivo completo modificado:
     - Línea por línea
     - Función por función
   - Validar coherencia, legibilidad y cumplimiento de reglas.

8. REGISTRO EN CHANGESLOGS.TXT
   - Registrar los cambios realizados indicando:
     - Archivo(s) modificado(s)
     - Línea(s) afectada(s)
     - Descripción objetiva del cambio
   - NO asumir éxito
   - NO usar términos como:
     - "Se corrigió"
     - "Se arregló"
     - "Se solucionó"

9. ACTUALIZACIÓN DE INSTRUCCIONES.TXT
   - Mover la tarea ejecutada al bloque:
     -> "TAREAS PENDIENTES DE REVISIÓN"
   - NO marcar la tarea como completada.

10. COMMIT
    - Realizar el commit SOLO después de cumplir
      todos los pasos anteriores.
    - El commit debe reflejar exactamente:
      - Lo documentado en ChangesLogs.txt
      - El estado actualizado de Instrucciones.txt


REGLA FINAL
-----------
Si un paso NO fue ejecutado, el proceso se considera INCOMPLETO.
NO se permiten atajos, omisiones ni reinterpretaciones.

---
**TAREAS PENDIENTES DE REVISIÓN**
---
========================================
REGISTRO DE TAREAS — BACKLOG ACTIVO
========================================

1. CORRECCIÓN Y NORMALIZACIÓN DEL FLUJO DE NAVEGACIÓN (CATEGORÍA, MARCA, BÚSQUEDA, TIPO DE ENCENDIDO)
Estado: PENDIENTE DE REVISIÓN POR PM
Origen: Reporte de PM + Requerimiento Funcional
Prioridad: ALTA
Área: Frontend | UI
Archivos involucrados: ui.js

Descripción:
Existe un conjunto de fallos y comportamientos inconsistentes en el flujo de navegación principal de la plataforma, que afectan:
- Navegación por categoría
- Navegación por marca
- Navegación por resultados de búsqueda
- Selección de versión de equipamiento y/o tipo de encendido

Problema identificado:
Cuando un modelo posee un único tipo de encendido, la lógica actual intenta omitir la pantalla de selección, provocando inconsistencias en el flujo de datos y errores de navegación. Un intento previo de corrección eliminó dicha omisión para forzar un flujo lineal, pero el problema persiste.

Flujo funcional requerido (OBLIGATORIO):

Navegación por Categoría:
1. Categoría
   - Mostrar categorías ordenadas por población.
2. Marcas
   - Mostrar solo marcas que tengan modelos dentro de la categoría seleccionada.
   - Orden alfabético ascendente (A–Z).
3. Modelos
   - Mostrar modelos que cumplan con la categoría y marca seleccionadas.
4. Versión de Equipamiento o Tipo de Encendido
   - Si el modelo tiene versiones de equipamiento, mostrarlas.
   - Si no tiene versiones, mostrar opciones por tipo de encendido (botón / llave).
   - La tarjeta debe mostrar nombre de la versión y tipo de encendido.
5. Años / Generación
   - Mostrar años disponibles según modelo y versión.

Navegación por Marca:
- Inicia desde la etapa de Marcas.
- No filtra por categoría.
- Debe seguir exactamente el mismo flujo desde la etapa de Modelos en adelante.

Búsqueda:
- Priorizar coincidencias por versión de equipamiento y modelo.
- Si coincide con marca, mostrar tarjeta de marca.
- La navegación desde cualquier resultado debe seguir el mismo flujo descrito arriba.

Requisitos adicionales:
- Todas las etapas deben tener botón de regreso funcional.
- El flujo debe ser gradual, reversible y consistente.
- El PM debe validar el flujo final antes de cerrar la tarea.

----------------------------------------

2. IMPLEMENTAR SISTEMA DE INBOX — AJUSTES VISUALES Y MAQUETADO
Estado: EN PROCESO
Origen: Requerimiento de Funcionalidad
Prioridad: ALTA
Área: Frontend | UI/UX
Archivos involucrados: UI del Inbox

Descripción:
La funcionalidad principal del sistema de Inbox está implementada e integrada con el servicio `services/feedback/feedback.js`, incluyendo:
- Listado de mensajes
- Detalle de mensajes
- Gestión por roles (Supervisor, Jefe, Desarrollador)

Pendiente:
- Aplicar estilos finales al modal de Inbox.
- Corregir problemas de desbordamiento de contenido.
- Asegurar una maquetación estable y consistente con el resto de la plataforma.

----------------------------------------

3. REPARAR FUNCIONALIDAD DEL BOTÓN "CAMBIAR CONTRASEÑA" EN GESTIÓN DE USUARIOS
Estado: EN PROCESO
Origen: Auditoría 11/01/2024
Prioridad: CRÍTICA
Área: Frontend
Archivo involucrado: users.html

Descripción:
Debido al uso de scripts como módulos (`type="module"`), las funciones JavaScript no están disponibles en el ámbito global para ser llamadas desde atributos `onclick`.

Estado actual:
- Los botones Crear, Editar y Eliminar ya fueron corregidos usando `addEventListener`.
- El botón "Cambiar Contraseña" continúa sin funcionar.

Acción requerida:
- Refactorizar completamente la lógica del botón "Cambiar Contraseña" para usar `addEventListener`.
- Eliminar cualquier dependencia de atributos `onclick` inline.

----------------------------------------

4. CORREGIR Y VALIDAR LA LÓGICA DEL MODO OSCURO
Estado: TAREA NUEVA (NO INICIADA)
Origen: Revisión por PM
Prioridad: BAJA
Área: Frontend | UI

Descripción:
- Verificar el correcto funcionamiento del botón de modo oscuro.
- Asegurar la inversión correcta de colores.
- Detectar y respetar el tema del sistema operativo.
- Validar contraste adecuado sobre fondo gris.
- Usar el logo correcto para modo oscuro: Logo_TemaOscuro.png (disponible en el repositorio).

----------------------------------------

5. ORGANIZAR Y LIMPIAR EL REPOSITORIO
Estado: TAREA NUEVA (NO INICIADA)
Origen: Revisión del PM
Prioridad: MEDIA
Área: Repositorio General

Descripción:
- Reorganizar la estructura de archivos del repositorio.
- Crear directorios adecuados para imágenes.
- Actualizar todas las URLs de imágenes usadas en el frontend.
- Evitar rutas rotas o referencias inconsistentes.

----------------------------------------

6. IMPLEMENTAR ANIMACIONES DE CARGA PARA OPERACIONES CRÍTICAS
Estado: TAREA NUEVA (NO INICIADA)
Origen: Implementación Nueva
Prioridad: ALTA
Área: Arquitectura | Funcionalidad

Descripción:
- Implementar animaciones de carga para:
  - Formularios
  - Operaciones que guardan o modifican datos en el Spreadsheet
- El modal de login debe tener una animación propia, coherente con su estilo y paleta de colores.
- La pantalla Splash de inicio NO debe modificarse bajo ninguna circunstancia.

----------------------------------------

7. MODAL DE VERIFICACIÓN DE EXISTENCIA DE VEHÍCULOS (FORMULARIO AGREGAR CORTE)
Estado: TAREA NUEVA (NO INICIADA)
Origen: Revisión del PM
Prioridad: CRÍTICA
Área: Funcional | Estructural

Nota obligatoria:
- HACER BACKUP de todos los archivos involucrados antes de iniciar.

Descripción:
- Revisar e implementar la lógica de la función `checkVehicle`.
- La etapa 1 debe mostrar un modal con:
  - Modelos coincidentes
  - Detalles de cortes existentes
  - Imágenes correctamente visibles con lógica propia de construcción de URLs
- Los botones de la etapa 1.5 no responden.
- Agregar botones para regresar a la etapa 1 (Marca, Modelo, Año, Tipo de Encendido).
- El botón actual regresa al catálogo, lo cual es incorrecto.
- La creación del vehículo funciona correctamente, pero:
  - No se genera el ID usando la fórmula del Spreadsheet.
  - Esto bloquea la ejecución correcta de la etapa 3.

----------------------------------------

8. FORMALIZAR Y DOCUMENTAR LA API DE MICROSERVICIOS
Estado: TAREA NUEVA (NO INICIADA)
Origen: Auditoría Técnica Forense v2.0
Prioridad: BAJA
Área: Arquitectura | Documentación

Descripción:
- Documentar todos los endpoints de cada microservicio.
- Definir contratos claros entre frontend y backend.
- Reducir errores por expectativas implícitas.
- Facilitar la incorporación de nuevos desarrolladores.

----------------------------------------

9. MODAL DE DETALLES DE RELAY — PINES NO VISIBLES
Estado: TAREA NUEVA (NO INICIADA)
Origen: Requerimiento Funcional
Prioridad: MEDIA
Área: Frontend | UI

Descripción:
- El modal de detalles de Relay no muestra la información de los pines.
- Revisar la lógica de construcción del URL de la imagen del diagrama.
- Asegurar que el URL incluya el parámetro `sz=1000` para el lightbox.

========================================
FIN DEL REGISTRO
========================================
