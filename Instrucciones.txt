=================================================
 INSTRUCTIVO DEL PROYECTO GPSpedia 2.0
=================================================
**Versión del Documento:** 4.0
**Fecha de Actualización:** 03/01/2026

Este documento detalla las normas de desarrollo, el estado de las tareas pendientes y el flujo de trabajo para el proyecto GPSpedia 2.0.

---------------------------------
NORMAS OBLIGATORIAS DE DESARROLLO
---------------------------------

**A. Control de Versiones y Documentación:**
1.  **Actualización de Versión:** Cualquier cambio debe reflejarse en el número de versión visible en `index.html` y en los servicios de Apps Script.
2.  **Consulta y Actualización de Documentación:** Antes y después de cualquier desarrollo, se deben consultar y actualizar `README.md`, `Instrucciones.txt` y `ChangesLogs.txt`.
3.  **Detalle en `ChangesLogs.txt`:** Cada entrada debe especificar el archivo y número de línea modificado.

**B. Calidad del Código:**
1.  **Comentarios:** Todo código nuevo o modificado debe tener un comentario explicando su propósito.

**C. Proceso de Aprobación:**
1.  **PROHIBIDO marcar tareas como “completadas” sin revisión del Project Manager.**
2.  **PROHIBIDO asumir que un cambio resolvió un problema.**
3.  **SOLO describir qué se cambió o qué se debe cambiar.**
4.  Si una tarea introduce nuevos errores: Marcar como **EN REVISIÓN**.
5.  Si la tarea no funciona o no cumple: Marcar como **REQUIERE NUEVA REVISIÓN**.

---------------------------------
ESTADO Y TAREAS PENDIENTES
---------------------------------

### Módulo: Layout y Navegación Principal

**Descripción funcional breve:** Componentes visuales y de navegación de la página principal (`index.html`), incluyendo la estructura de carruseles y la presentación de categorías y marcas.

**Archivos involucrados:**
- `index.html`
- `services/catalog/catalog.js`

**Tareas pendientes:**
- [ ] **(BUG)** El carrusel "Marcas de motos" rompe la carga del catálogo.
  - **Impacto esperado:** La creación de este carrusel causa un error `crearCarrusel is not defined` que impide la visualización de todo el catálogo.
  - **Riesgos conocidos:** La lógica de `crearCarrusel` puede tener dependencias de scope o de tiempo de ejecución que no se están cumpliendo.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(INCONSISTENCIA)** El layout de la página principal no sigue el orden definido en `README.md`.
  - **Impacto esperado:** La sección "Últimos Agregados" debe mostrarse *antes* que "Categorías". Actualmente se muestra después.
  - **Riesgos conocidos:** Cambiar el orden de renderizado podría afectar la inicialización de los carruseles si no se hace correctamente.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(INCOMPLETO)** El carrusel "Últimos Agregados" muestra 10 tarjetas en lugar de 6.
  - **Impacto esperado:** La UI debe mostrar un carrusel más compacto con solo 6 elementos para mejorar la visualización inicial.
  - **Riesgos conocidos:** Ninguno.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(INCONSISTENCIA)** Las categorías se ordenan alfabéticamente en el frontend.
  - **Impacto esperado:** El backend (`catalog.js`) debe ser el responsable de ordenar las categorías por popularidad (cantidad de vehículos) antes de enviarlas al frontend. El frontend no debe re-ordenarlas.
  - **Riesgos conocidos:** La lógica de conteo y ordenamiento en el backend debe ser eficiente para no retrasar la carga inicial.
  - **Dependencias:** Tarea de backend en `catalog.js`.
  - **Estado:** PENDIENTE

- [ ] **(BUG)** La navegación por "Categoría -> Marca" muestra texto en lugar de íconos.
  - **Impacto esperado:** La UI debe renderizar los logos de las marcas (`<img>`) en lugar de texto plano para una experiencia de usuario más visual y consistente.
  - **Riesgos conocidos:** Depende de que las URLs de los logos en la base de datos sean correctas y accesibles.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

### Módulo: Modal de Detalles de Vehículo

**Descripción funcional breve:** Gestiona la visualización de toda la información de un vehículo en un modal, incluyendo cortes, imágenes, y datos suplementarios.

**Archivos involucrados:**
- `index.html`

**Tareas pendientes:**
- [ ] **(INCOMPLETO)** La funcionalidad "Sugerir Año" no está vinculada al botón "Útil".
  - **Impacto esperado:** El flujo de usuario debe ser: clic en "Útil" -> se registra el "like" -> se presenta el prompt para sugerir un año. Actualmente son acciones separadas o no vinculadas.
  - **Riesgos conocidos:** Requiere modificar la lógica del `event listener` del botón "Útil" para encadenar ambas acciones.
  - **Dependencias:** Depende de la tarea de backend "Lógica de Votación para Sugerir Año".
  - **Estado:** PENDIENTE

- [ ] **(INCOMPLETO)** No existen placeholders para la edición "in-modal" de campos vacíos.
  - **Impacto esperado:** La UI debe mostrar un ícono de "editar" junto a los campos de texto del modal. Si el campo está vacío, el ícono debe permitir al usuario ingresar datos (solo visualmente, sin guardar).
  - **Riesgos conocidos:** La lógica para gestionar el estado visual de los campos (vacío/con datos, ícono activado/desactivado) puede ser compleja.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(BUG)** Las imágenes en el modal de detalle no tienen el layout correcto.
  - **Impacto esperado:** Se debe reducir el espacio vertical y ajustar el `width` y `height` de las imágenes para un diseño más compacto.
  - **Riesgos conocidos:** Los cambios de CSS deben ser específicos para no afectar otras imágenes en la aplicación.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(BUG)** Los logos de marca en el modal no tienen el estilo correcto.
  - **Impacto esperado:** El logo debe mostrarse sin bordes, con fondo transparente y un efecto `drop-shadow`.
  - **Riesgos conocidos:** Ninguno.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

### Módulo: Sistema de Feedback y Calidad de Datos

**Descripción funcional breve:** Lógica de backend para gestionar las interacciones de los usuarios que mejoran la calidad de los datos, como la sugerencia de años.

**Archivos involucrados:**
- `services/feedback/feedback.js`

**Tareas pendientes:**
- [ ] **(INCOMPLETO)** La lógica de backend para "Sugerir Año" es demasiado simple y no sigue las reglas de negocio.
  - **Impacto esperado:** La función `handleSuggestYear` debe ser reescrita para implementar un sistema de votación (requiere 3 votos para confirmar un cambio) y una lógica "anti-colisión" para evitar el solapamiento de rangos de años entre diferentes generaciones de vehículos.
  - **Riesgos conocidos:** La lógica anti-colisión requiere una búsqueda compleja en la base de datos y puede ser propensa a errores si no se manejan todos los casos borde.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

### Módulo: Sistema de Catálogo (Backend)

**Descripción funcional breve:** Servicio de backend responsable de leer y proveer los datos del catálogo al frontend.

**Archivos involucrados:**
- `services/catalog/catalog.js`

**Tareas pendientes:**
- [ ] **(INCOMPLETO)** El servicio no ordena las categorías por popularidad.
  - **Impacto esperado:** La función `handleGetCatalogData` debe calcular el número de vehículos por categoría y ordenar la lista de categorías de forma descendente antes de devolverla.
  - **Riesgos conocidos:** Puede impactar ligeramente el rendimiento de la carga inicial.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

- [ ] **(DEUDA TÉCNICA)** La conversión de URLs a thumbnails se realiza en el frontend.
  - **Impacto esperado:** Esta lógica debe moverse al backend (`catalog.js`) para centralizarla, optimizar el rendimiento y reducir la carga en el cliente. Se debe crear una función `convertirAGoogleThumbnail` y aplicarla a todos los campos de URL de imagen.
  - **Riesgos conocidos:** Asegurarse de que la nueva función de backend sea robusta y maneje todos los formatos de URL de Google Drive existentes en la base de datos.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

### Módulo: Formulario de Adición de Cortes

**Descripción funcional breve:** Gestiona el flujo de trabajo de múltiples pasos para agregar nuevos vehículos y cortes a la base de datos.

**Archivos involucrados:**
- `add_cortes.html`
- `services/write/write.js`

**Tareas pendientes:**
- [ ] **(FALTA REVISIÓN)** El flujo de escritura fue refactorizado.
  - **Impacto esperado:** Se implementó una nueva lógica anti-duplicados con una interfaz de botones inline. Se necesita una revisión completa por parte del Project Manager para validar que cumple con todos los requisitos y no introduce regresiones.
  - **Riesgos conocidos:** La complejidad del flujo de múltiples pasos puede ocultar bugs o casos borde no manejados.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE

### Módulo: Gestión de Versiones y Documentación

**Descripción funcional breve:** Tareas relacionadas con el mantenimiento de la documentación del proyecto y el sistema de versionamiento.

**Archivos involucrados:**
- `ChangesLogs.txt`
- `Instrucciones.txt`
- `README.md`

**Tareas pendientes:**
- [ ] **(DEUDA TÉCNICA)** Existen inconsistencias de versionamiento.
  - **Impacto esperado:** Sincronizar la versión global para que el próximo gran lanzamiento sea `v2.0` y mejorar el formato de registro de fechas en `ChangesLogs.txt` para que sea consistente.
  - **Riesgos conocidos:** Ninguno.
  - **Dependencias:** Ninguna.
  - **Estado:** PENDIENTE
