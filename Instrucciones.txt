Importante: 
PROHIBIDO AGREGAR CONTENIDO ANTES DEL SIGUIENTE BLOQUE DE TEXTO. 

— PROCEDIMIENTO OBLIGATORIO DE TRABAJO.
===================================================================

Este procedimiento es de CUMPLIMIENTO OBLIGATORIO en TODOS los proyectos.
No se permite omitir, alterar ni reordenar pasos.

--------------------------------------------------
FLUJO PRINCIPAL DE TRABAJO
--------------------------------------------------

1. AUDITORÍA INICIAL DEL ARCHIVO
   - Auditar el/los archivo(s) involucrados.
   - Revisión archivo por archivo.
   - Revisión línea por línea.
   - Identificar estado actual, riesgos, dependencias y efectos colaterales.
   - PROHIBIDO modificar código en esta etapa.

2. REGISTRO DE HALLAZGOS
   - Registrar TODOS los hallazgos en Auditoría.txt.
   - Crear nueva entrada o actualizar la existente.
   - PROHIBIDO eliminar información previa.
   - NO realizar correcciones durante la auditoría.

3. MANEJO DE HALLAZGOS FUERA DE ALCANCE
   - Si se detectan problemas fuera de la tarea actual:
     a) Resolverlos en el MISMO commit SOLO si es seguro.
     b) Si no es posible:
        -> Registrar nueva tarea en Instrucciones.txt
        -> Referenciarla en Auditoría.txt

4. RESPALDO OBLIGATORIO ANTES DE EDICIÓN
   - Crear copia exacta del/los archivo(s) a modificar.
   - El respaldo DEBE conservar:
     · Nombre original
     · Contenido íntegro
   - El respaldo se usa EXCLUSIVAMENTE para comparación posterior.

5. EJECUCIÓN DE LA TAREA
   - Implementar ÚNICAMENTE lo solicitado.
   - PROHIBIDO:
     · Cambiar estilos no relacionados
     · Alterar flujos existentes
     · Introducir optimizaciones no solicitadas
   - Todo cambio debe estar justificado por la tarea.

6. VERIFICACIÓN FUNCIONAL
   - Confirmar que la tarea cumple su objetivo.
   - Verificar que no se rompan funciones existentes.
   - Probar flujos relacionados directa e indirectamente.

7. COMPARACIÓN POST-EDICIÓN (OBLIGATORIA)
   - Comparar archivo editado contra el respaldo previo.
   - Identificar:
     · Líneas eliminadas
     · Líneas modificadas
     · Bloques sobreescritos
   - Verificar que:
     -> TODO cambio esté directamente relacionado con la tarea.
   - Si se detectan cambios ajenos:
     -> REVERTIRLOS inmediatamente
     -> Repetir la comparación
-Los archivos de Respaldo se debe eliminar DESPUES de la revision de codigo de Code Review. 
-Todo archivo, captura generado para la verificación visual o ejecutable debe de ser eliminado en el pre-commit. 

8. VERIFICACIÓN DE INTEGRIDAD Y EFECTOS COLATERALES
   - Revisar dependencias internas y externas.
   - Detectar efectos colaterales visuales o lógicos.
   - Confirmar que no existen regresiones.

9. REVISIÓN FINAL DE CÓDIGO
   - Revisión completa nuevamente.
   - Línea por línea.
   - Función por función.
   - Evaluar consistencia, claridad y impacto.

10. REGISTRO EN CHANGESLOGS.TXT
    - Registrar TODOS los cambios realizados.
    - Indicar:
      · Archivo modificado
      · Líneas afectadas
      · Descripción objetiva
    - PROHIBIDO asumir éxito o usar frases de cierre.

11. ACTUALIZACIÓN DE INSTRUCCIONES.TXT
    - Mover la tarea ejecutada a:
EXTENSIÓN OBLIGATORIA POR CODE REVIEW
--------------------------------------------------

Si el Code Review detecta:
- Fallas
- Bloqueantes
- Riesgos
- Cambios requeridos

ENTONCES:
-> Este MISMO procedimiento DEBE aplicarse nuevamente
-> Incluso si implica modificar archivos ya editados
-> NO se permiten correcciones parciales


==================================================
PROTOCOLO DE RESULTADO DE CODE REVIEW
==================================================

--------------------------------------------------
FLUJO DE ANÁLISIS
--------------------------------------------------

1. LECTURA COMPLETA DEL CODE REVIEW
   - Leer TODO el informe.
   - No omitir secciones.

2. SAFETY & SIDE EFFECTS
   - Se considera FUENTE DE VERDAD PRINCIPAL.
   - SOLO se ignora si el Code Review solicita
     explícitamente revertir cambios.

--------------------------------------------------
TRATAMIENTO DE REVERSIÓN
--------------------------------------------------

3. EVALUACIÓN OBLIGATORIA

   a) CAMBIOS "OUT OF SCOPE"
      - Verificar si pertenecen a:
        · Tareas anteriores
        · Commits previos aprobados

      - Si pertenecen a tareas anteriores:
        -> IGNORAR solicitud de reversión
        -> CONTINUAR con el commit actual

   b) CAMBIOS DE LA TAREA ACTUAL
      - Si los cambios NO solicitados
        fueron introducidos durante la tarea actual:
        -> REALIZAR reversión
        -> REGISTRAR el motivo

--------------------------------------------------
IMPACTO EN EL FLUJO
--------------------------------------------------

4. REINICIO DEL CICLO
   - Toda observación que implique cambios:
     -> REINICIA el ciclo completo
        desde la AUDITORÍA INICIAL

   - El reinicio NO afecta:
     · Commits anteriores
     · Tareas aprobadas
     · Cambios fuera de alcance


--------------------------------------------------
DOCUMENTACIÓN OBLIGATORIA
--------------------------------------------------

Toda acción derivada del Code Review
DEBE quedar registrada en:
- Auditoría.txt
- ChangesLogs.txt
- Instrucciones.txt (si aplica)


--------------------------------------------------
REGLA FINAL ABSOLUTA
--------------------------------------------------

SI NO SE AUDITA, NO SE CAMBIA.
SI NO SE REGISTRA, NO EXISTE.

El incumplimiento de CUALQUIER paso
INVALIDA el proceso completo.

---
*No hay tareas pendientes en esta sección.*

---
**DERIVADO DE AUDITORÍA — NO EJECUTAR AÚN**
---
*No hay tareas pendientes en esta sección.*

---
**TAREAS COMPLETADAS (Validadas por el PM)**
---
1. **TÍTULO: Implementación de Modal de Verificación y Mejoras en Flujo de Cortes (v4.9.15)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Funcional | Estructural | UI/UX
   - **ALCANCE:** Formulario `add_cortes.html` y servicio `write.js`.
   - **DESCRIPCIÓN DETALLADA:**
     - **Etapa 1.5:** Implementación completa del modal anti-duplicado con previsualización de imagen de vehículo y cortes (120x90).
     - **Lightbox:** Integración de lightbox funcional para las imágenes de los cortes en la verificación.
     - **Navegación:** Corrección de botones inactivos y adición de navegación "Volver" entre todas las etapas.
     - **Backend:** Mejora en la lógica de generación de ID en `write.js` asegurando la presencia de fórmulas.
     - **Versionamiento:** Proyecto actualizado a v4.9.15.

2. **TÍTULO: Reparación de Layout de Búsqueda y Box-Sizing (v4.9.9)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Bugfix Layout / CSS Robustness
   - **ALCANCE:** Corrección del desbordamiento horizontal de la barra de búsqueda.
   - **DESCRIPCIÓN DETALLADA:**
     - **Reset:** Implementación de `box-sizing: border-box` global.
     - **Layout:** Refinamiento de la unificación de búsqueda para garantizar ancho del 100% real.
     - **Versión:** Incremento a v4.9.9.

3. **TÍTULO: Reparación Definitiva y Alta Densidad de Inbox (v4.9.12)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** UI/UX Repair / High Density
   - **ALCANCE:** Corrección estructural y visual completa del módulo de Inbox.
   - **DESCRIPCIÓN DETALLADA:**
     - **Estructura:** Eliminación de estilos inline en index.html que bloqueaban el diseño.
     - **Densidad:** Reducción drástica de márgenes y paddings para maximizar área útil.
     - **Tipografía:** Reducción de fuentes en títulos de modal, detalle e ítems.
     - **Interactividad:** Implementación de paneles con scroll independiente y gaps mínimos.
     - **Versionamiento:** Incremento a v4.9.12.

4. **TÍTULO: Refactorización de estilos de bandeja de entrada y corrección de metadatos (v4.9.13)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** UI/UX
   - **ALCANCE:** Estilos de Inbox de alta densidad y visualización de nombre de vehículo.
   - **DESCRIPCIÓN DETALLADA:**
     - **Estilo Inbox:** Reducción de fuentes, márgenes mínimos y scroll independiente por panel.
     - **Metadatos:** Conversión de ID de vehículo a Marca/Modelo/Año en el detalle del Inbox.

2. **TÍTULO: Finalización de Backlog y Nuevas Funcionalidades (v4.9.8)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Feature / Optimization / Bugfix
   - **ALCANCE:** Entrega final de 7 tareas críticas + Dashboard + Edición + Sugerencia de Años.
   - **DESCRIPCIÓN DETALLADA:**
     - **Dashboard:** Panel de actividad para roles autorizados.
     - **Sugerencia de Años:** Interfaz de usuario para proponer datos.
     - **Edición:** Acceso directo a edición desde el catálogo.
     - **Rendimiento:** Implementación de Lazy Load e inicio reactivo.
     - **Audit-Fix:** Resolución de errores de referencia y unificación de CSS.

2. **TÍTULO: Correcciones Críticas GPSpedia (v4.9.7)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Optimización / Bugfix / UX / Robustez
   - **ALCANCE:** Ejecución del backlog de 7 tareas críticas.
   - **DESCRIPCIÓN DETALLADA:**
     - **Splash Screen:** Carga no bloqueante de datos en segundo plano mediante sistema de observadores en `state.js`.
     - **Búsqueda:** Refinamiento de lógica de años (1900-2100) y priorización de modelos exactos.
     - **Videos:** Normalización robusta de URLs de YouTube en backend y frontend.
     - **Inbox:** Extracción resiliente de datos desde el API de feedback.
     - **Animaciones:** Optimización GPU del header para evitar lag.
     - **Imágenes:** Incremento de resolución para pantallas de alta densidad.

3. **TÍTULO: Reparación de Precisión de Layout y Logo (v4.9.6)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Refinamiento UI / Bugfix Layout / Unificación CSS
   - **ALCANCE:** Corrección milimétrica de centrado de logo y desbordamiento horizontal.

4. **TÍTULO: Corrección de Regresiones del Header (v4.9.5)**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Bugfix / UX / Regresión

5. **TÍTULO: Restauración de Animaciones y Botón Hamburguesa**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Fix UX / UI Regression / Animaciones

6. **TÍTULO: Reconstrucción Extrema del Header y Fix de Espacio Fantasma**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Refactor Estructural / Layout Móvil / UX

7. **TÍTULO: Corrección de Causa Raíz de Fallos en Búsqueda y Modal**
   - **ESTADO:** COMPLETADO
   - **TIPO:** Corrección de Causa Raíz / Bug de Datos / Bug Visual de CSS

8. MEJORA Y REFINAMIENTO DE ANIMACIÓN DE BÚSQUEDA
Estado: COMPLETADO
Origen: Refinamiento UX
Prioridad: Normal
Área: Frontend | UI | CSS | JS
Archivos involucrados: style.css, main.js

9. INVESTIGAR CIERRE DE SESIÓN INESPERADO TRAS REFRESH
Estado: COMPLETADO
Origen: Reporte de Bug
Prioridad: CRÍTICA
Área: Frontend | Autenticación | Estado
Archivos involucrados: auth.js

10. CORRECCIÓN DEL SISTEMA DE BÚSQUEDA Y NAVEGACIÓN
Estado: COMPLETADO
Origen: Múltiples reportes de bugs y regresiones.
Prioridad: CRÍTICA
Área: Frontend | Navegación | Búsqueda | UX
Archivos involucrados: ui.js, navigation.js

---
**TAREAS PENDIENTES DE REVISIÓN**
---
*No hay tareas pendientes en esta sección.*
