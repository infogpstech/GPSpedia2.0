**V4.7.2 - (CRITICAL NAV FIX) - 16/01/2026**
**A. RESUMEN GENERAL:** Se implementó una corrección definitiva para un bug crítico y persistente en la navegación hacia atrás que ocurría en flujos específicos. Esta solución asegura que la navegación sea reversible y estable en todos los escenarios.

**B. Corrección Implementada:**
1.  **Manejo de Parámetros Nulos en Botón "Volver" (`ui.js`):**
    *   **Problema:** Al navegar por la ruta `Modelo -> Versión de Equipamiento -> Año` y presionar "Volver", la aplicación fallaba con un error (`... para 'Captiva' null`).
    *   **Causa Raíz:** La función `mostrarVersiones` construía incorrectamente la llamada de retorno, pasando el valor `null` de la versión de equipamiento como una cadena de texto (`'null'`) en lugar de como un valor nulo real.
    *   **Solución:** Se refactorizó la lógica que construye el `onclick` del botón "Volver" en la función `mostrarVersiones`. Ahora, se valida explícitamente si la versión de equipamiento existe. Si no existe, se pasa el valor `null` correctamente, evitando la conversión a string y asegurando que la función de retorno reciba los parámetros correctos.
    *   **Líneas Afectadas en `ui.js`:** 426-429.

**C. Impacto:**
- **Navegación Estable y Predecible:** Se ha eliminado el bug que rompía la navegación hacia atrás. El flujo de usuario es ahora completamente reversible y funcional, independientemente de la ruta de navegación que se tome.

**V4.7.1 - (FIX) - 15/01/2026**
**A. RESUMEN GENERAL:** Se implementó una corrección definitiva al flujo de navegación, solucionando un error lógico introducido en la refactorización anterior. Se ha restaurado el flujo funcional requerido y se ha robustecido la navegación hacia atrás.

**B. Cambios Implementados:**
1.  **Corrección del Flujo `Versión de Equipamiento` (`ui.js`):**
    *   **Problema:** Al seleccionar una "Versión de Equipamiento", el sistema navegaba incorrectamente a la pantalla de "Tipo de Encendido", creando un paso extra no deseado en el flujo.
    *   **Solución:** Se modificó la función `mostrarVersionesEquipamiento`. El evento `onclick` de cada tarjeta de versión ahora filtra los datos correspondientes a esa versión y navega directamente a `mostrarVersiones` (la pantalla de selección de Año/Generación), omitiendo el paso incorrecto.
    *   **Líneas Afectadas en `ui.js`:** 465-467.

2.  **Mejora de la Información en Tarjetas (`ui.js`):**
    *   **Problema:** Las tarjetas en la pantalla de "Versión de Equipamiento" solo mostraban el nombre de la versión.
    *   **Solución:** Se mejoró el renderizado de estas tarjetas para incluir también los tipos de encendido asociados a cada versión, proporcionando más contexto al usuario, tal como se requería.
    *   **Líneas Afectadas en `ui.js`:** 476-477.

3.  **Robustecimiento de la Navegación Hacia Atrás (`ui.js`):**
    *   **Problema:** Los botones "Volver" en las pantallas de "Tipo de Encendido" y "Año/Generación" tenían una lógica estática que fallaba si el usuario llegaba a través de un flujo alternativo (como el de "Versión de Equipamiento").
    *   **Solución:** Se refactorizaron las funciones `mostrarTiposEncendido` y `mostrarVersiones` para que utilicen el `navigationState` guardado. Ahora, determinan dinámicamente cuál fue la pantalla anterior y construyen el `onclick` del botón "Volver" para que siempre regrese al paso previo correcto, garantizando una navegación reversible y predecible.
    *   **Líneas Afectadas en `ui.js`:** 370-381, 418-426.

**C. Impacto:**
- **Flujo de Navegación Correcto:** La aplicación ahora sigue estrictamente el flujo funcional requerido (`Modelo -> [Versión O Encendido] -> Año`), eliminando pasos incorrectos y confusos.
- **Experiencia de Usuario Mejorada:** La navegación hacia atrás es ahora completamente fiable, y las tarjetas de versión de equipamiento son más informativas, mejorando la usabilidad general.

**V4.7.0 - (REFACTOR) - 15/01/2026**
**A. RESUMEN GENERAL:** Se ejecutó una refactorización integral del flujo de navegación en `ui.js` para corregir inconsistencias, normalizar el comportamiento y alinearlo con los requisitos funcionales. Se ha establecido un flujo de usuario lógico, predecible y reversible.

**B. Cambios Implementados:**
1.  **Centralización de la Lógica de Navegación (`ui.js`):**
    *   **Problema:** El flujo de navegación estaba fragmentado y era inconsistente, especialmente después de seleccionar un modelo. La aplicación no decidía correctamente si mostrar "Versiones de Equipamiento" o "Tipos de Encendido".
    *   **Solución:** Se creó una nueva función `navegarADetallesDeModelo`. Esta función actúa como un "hub" central que analiza los datos de un modelo seleccionado y dirige al usuario a la pantalla correcta, ya sea `mostrarVersionesEquipamiento` o `mostrarTiposEncendido`, garantizando el flujo correcto.
    *   **Líneas Afectadas en `ui.js`:** 303-334 (nueva función `navegarADetallesDeModelo`).

2.  **Unificación de Puntos de Entrada (`ui.js`):**
    *   **Problema:** Diferentes partes de la aplicación (navegación por categoría, por marca, búsqueda) tenían sus propias lógicas `onclick` que llevaban a flujos inconsistentes.
    *   **Solución:** Se refactorizaron las funciones `mostrarModelos`, `mostrarModelosPorMarca` y `mostrarResultadosBusquedaModelo` para que todas utilicen la nueva función `navegarADetallesDeModelo` en sus eventos `onclick`. Esto unifica el comportamiento en toda la aplicación.
    *   **Líneas Afectadas en `ui.js`:** 289, 357, 519.

3.  **Corrección del Flujo de Versiones de Equipamiento (`ui.js`):**
    *   **Problema:** La función `mostrarVersionesEquipamiento` no estaba correctamente integrada en el flujo y no filtraba por modelo.
    *   **Solución:** Se modificó la función para que acepte el `modelo` como parámetro, filtre las versiones de equipamiento específicas para ese modelo y asegure que el botón "Volver" y los clics en las tarjetas dirijan al usuario a los pasos correctos del flujo unificado.
    *   **Líneas Afectadas en `ui.js`:** 427-456.

4.  **Optimización del Código (`ui.js`):**
    *   **Problema:** La función `mostrarResultadosBusquedaVersion` se volvió redundante después de centralizar la lógica en `navegarADetallesDeModelo`.
    *   **Solución:** Se eliminó la función `mostrarResultadosBusquedaVersion` para limpiar el código y evitar confusiones.
    *   **Líneas Afectadas en `ui.js`:** 531-551 (eliminadas).

5.  **Ordenamiento por Relevancia (`ui.js`):**
    *   **Problema:** Las categorías no estaban ordenadas por relevancia.
    *   **Solución:** Se modificó `mostrarCategorias` para ordenar las tarjetas de categorías según la cantidad de vehículos que contienen (población), de mayor a menor.
    *   **Líneas Afectadas en `ui.js`:** 167-175.

**C. Impacto:**
- **Navegación Consistente y Predecible:** Todos los flujos de navegación (categoría, marca, búsqueda) ahora convergen en un comportamiento único y correcto, eliminando errores y mejorando la experiencia del usuario.
- **Mantenibilidad del Código:** La centralización de la lógica de decisión en una sola función (`navegarADetallesDeModelo`) hace que el código sea más fácil de entender, depurar y mantener.

**V4.6.0 - (FEATURE) - 15/01/2026**
**A. RESUMEN GENERAL:** Se implementaron los estilos visuales para el sistema de Inbox, completando la Tarea 18. La funcionalidad, que ya estaba presente en el código, es ahora completamente accesible y usable para los roles de usuario designados.

**B. Cambios Implementados:**
1.  **Implementación de Estilos del Inbox (`style.css`):**
    *   **Problema:** El modal del Inbox carecía de cualquier estilo, haciéndolo inutilizable.
    *   **Solución:** Se añadió un nuevo bloque de CSS (`/* --- ESTILOS DEL MODAL DE INBOX --- */`) que define la apariencia y el comportamiento de todos los componentes del sistema de Inbox.
    *   **Detalles de Estilos Añadidos:**
        *   `.inbox-item`: Define el layout de cada mensaje en la lista, con estados `:hover` y `.active`.
        *   `.inbox-item.resolved` y `.inbox-item.replied`: Añaden indicadores visuales para los mensajes resueltos (opacidad reducida) y los respondidos (etiqueta de texto).
        *   `#inbox-detail`: Estilos para el panel de detalles del mensaje.
        *   `.inbox-message-content`, `.inbox-reply-content`: Contenedores visualmente diferenciados para el mensaje original y la respuesta.
        *   `.inbox-actions`: Estilos para el `textarea` y los botones de "Enviar Respuesta" y "Marcar como Resuelto", asegurando consistencia con el diseño de la aplicación.
    *   **Líneas Afectadas en `style.css`:** 1095-1185.

2.  **Actualización de Versión (`index.html`):**
    *   Se incrementó el número de versión a `4.6.0` para reflejar la adición de la nueva funcionalidad.
    *   **Líneas Afectadas en `index.html`:** 1.

**C. Impacto:**
- **Funcionalidad Completada:** El sistema de gestión de feedback (Inbox) es ahora una herramienta completamente funcional y visualmente integrada en la aplicación, permitiendo a los administradores gestionar la comunicación con los usuarios de manera eficiente.

**V4.5.2 - (NAV BUG FIX) - 14/01/2026**
**A. RESUMEN GENERAL:** Se corrigió un bug en el flujo de navegación que ocurría en la etapa de selección de "Tipo de Encendido".

**B. Corrección Implementada:**
1.  **Bug de Flujo de Navegación (`ui.js`):**
    *   **Problema:** Cuando un modelo de vehículo tenía un solo tipo de encendido, el sistema se saltaba la pantalla de selección, pasando un conjunto de datos incorrectamente filtrado a la siguiente etapa y rompiendo el flujo.
    *   **Causa Raíz:** Una lógica de "optimización" en la función `mostrarTiposEncendido` que no consideraba los casos en los que múltiples rangos de años existían para un único tipo de encendido.
    *   **Solución:** Se eliminó el bloque condicional que causaba el salto. Ahora, la pantalla de selección de "Tipo de Encendido" se mostrará siempre, incluso si solo hay una opción. Esto garantiza que el flujo de datos sea consistente y predecible, resolviendo el bug.
    *   **Líneas Afectadas en `ui.js`:** 346-349.

**C. Impacto:**
- **Estabilidad de la Navegación:** Se ha restaurado el flujo de navegación correcto para todos los casos, asegurando que los usuarios puedan llegar al detalle del vehículo sin errores, independientemente de la estructura de los datos.

**V4.5.1 - (UI & DOCS UPDATE) - 14/01/2026**
**A. RESUMEN GENERAL:** Se implementaron ajustes de diseño en el modal de detalles del vehículo y se actualizó la documentación (`README.md`) para reflejar los nuevos requisitos visuales, según la solicitud del Project Manager.

**B. Cambios Implementados:**
1.  **Actualización de Documentación (`README.md`):**
    *   **Problema:** La descripción del layout del encabezado del modal era incorrecta y faltaba un ejemplo visual.
    *   **Solución:** Se actualizó el texto para indicar que el logo de la marca debe aparecer a la izquierda del título. Se añadió una nueva sección con un diagrama ASCII y una lista detallada de requisitos que describen la estructura y el orden del contenido del modal.
    *   **Líneas Afectadas en `README.md`:** 991-1078.

2.  **Ajuste del Layout del Encabezado (`ui.js`):**
    *   **Problema:** El logo de la marca aparecía a la derecha del título del modelo.
    *   **Solución:** Se refactorizó la función `mostrarDetalleModal` para reordenar la creación de los elementos del DOM, insertando el logo *antes* que el título y ajustando el estilo `justify-content` a `flex-start` para asegurar una alineación a la izquierda.
    *   **Líneas Afectadas en `ui.js`:** 532-550.

3.  **Ajuste de Tamaño de Imágenes (`style.css`):**
    *   **Problema:** El tamaño del logo de la marca y de la imagen del vehículo no cumplían con los nuevos requisitos de diseño.
    *   **Solución:** Se modificaron las reglas de CSS para:
        *   Aumentar la altura del logo de la marca en un 10% (a `44px`) en la clase `.brand-logo-modal`.
        *   Reducir el ancho máximo de la imagen del vehículo en un 10% (a `225px`) en la clase `.img-vehiculo-modal`.
    *   **Líneas Afectadas en `style.css`:** 777-781, 790.

**C. Impacto:**
- **Consistencia Visual y Documental:** El diseño del modal de detalles del vehículo ahora coincide con los requisitos visuales más recientes, y la documentación en `README.md` actúa como una fuente de verdad precisa para la estructura de la UI.

**V4.5.0 - (REGRESSION FIX) - 14/01/2026**
**A. RESUMEN GENERAL:** Se implementó una corrección integral para un conjunto de regresiones críticas en el frontend que afectaban la navegación principal y la visualización de detalles en los modales, restaurando la funcionalidad y el diseño a las especificaciones definidas en la documentación.

**B. Correcciones Implementadas:**
1.  **Restauración de la Navegación Principal (`ui.js`):**
    *   **Problema:** Las secciones "Últimos agregados", "Marcas de Vehículos" y "Marcas de Motocicletas" desaparecían después de la primera interacción del usuario.
    *   **Causa Raíz:** La lógica de navegación era destructiva, borrando el contenido principal en cada clic.
    *   **Solución:** Se refactorizó el flujo de navegación para que sea lineal y jerárquico. Se implementó una nueva función `mostrarModelosPorMarca` para manejar correctamente la transición de "Marca" a "Modelos", y se ajustaron los `onclick` para seguir este flujo, asegurando que todas las secciones principales permanezcan visibles.
    *   **Líneas Afectadas en `ui.js`:** 195, 211, 254-292 (nueva función `mostrarModelosPorMarca` reemplazando `mostrarCategoriasPorMarca`).

2.  **Corrección de Contenido en Modales (`ui.js`):**
    *   **Problema:** Los videos en los modales de tutoriales y las imágenes en los modales de relay no se mostraban si el dato correspondiente faltaba.
    *   **Solución:** Se refactorizaron las funciones `mostrarDetalleTutorialModal` y `mostrarDetalleRelayModal` para construir el DOM de forma segura con `appendChild` y validar la existencia de los datos (`item.Video`, `item.imagen`) antes de intentar renderizar los elementos.
    *   **Líneas Afectadas en `ui.js`:** 1158-1188, 1199-1237.

3.  **Corrección de Diseño del Modal de Vehículos (`ui.js` y `style.css`):**
    *   **Problema:** El logo de la marca, los botones de feedback y el nombre del colaborador estaban mal posicionados.
    *   **Solución (`ui.js`):** Se reordenó la creación de elementos en `mostrarDetalleModal` para colocar el logo a la derecha del título (Líneas 533-551). Se asignó la clase `colaborador-info` al párrafo del colaborador para un estilo dedicado (Línea 697).
    *   **Solución (`style.css`):** Se ajustó la regla `.feedback-overlay` para un posicionamiento preciso de los botones (Líneas 822-827). Se añadió la nueva clase `.colaborador-info` para garantizar que el texto del colaborador tenga su propio espacio vertical (Líneas 829-838).

**C. Impacto:**
- **Funcionalidad de Navegación Restaurada:** Los usuarios ahora pueden navegar por el catálogo de manera lógica y predecible sin perder el contexto.
- **Estabilidad de la UI:** Los modales ahora manejan correctamente los datos faltantes, evitando errores de renderizado.
- **Consistencia Visual:** El diseño del modal de detalles ahora cumple con las especificaciones visuales del `README.md`.
