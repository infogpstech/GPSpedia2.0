**v4.4.3 (31-12-2025)**
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `GPSpedia-Catalog` a la nueva versi贸n desplegada, asegurando que el frontend apunte al endpoint m谩s reciente tras la implementaci贸n de la b煤squeda flexible.
    *   **Archivos Modificados:** `api-manager.js`: L铆nea 11.

**v4.4.2 (31-12-2025)**
*   **FIX & FEAT (services/catalog/catalog.js):** Se solucion贸 el error "Par谩metros de b煤squeda incompletos" y se implement贸 una l贸gica de b煤squeda flexible.
    *   **Correcci贸n:** Se aline贸 el par谩metro `anoDesde` en la funci贸n `handleCheckVehicle` con los datos enviados desde el frontend, eliminando el error.
    *   **Nueva Funcionalidad:** Se refactoriz贸 la b煤squeda para que `marca` y `modelo` utilicen coincidencias parciales e insensibles a may煤sculas/min煤sculas, mientras que `a帽o` y `tipo de encendido` siguen siendo exactos. La funci贸n ahora devuelve una lista de todas las coincidencias.
    *   **Archivos Modificados:** `services/catalog/catalog.js`: L铆neas 330-366.

**v4.4.1 (31-12-2025)**
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `GPSpedia-Catalog` a la nueva versi贸n desplegada, asegurando que el frontend apunte al endpoint m谩s reciente tras la correcci贸n del bug de carga de formularios.
    *   **Archivos Modificados:** `api-manager.js`: L铆nea 11.

**v4.4.0 (31-12-2025)**
*   **HOTFIX (services/catalog/catalog.js):** Se solucion贸 un error cr铆tico de `TypeError: Cannot read properties of undefined (reading 'categoria')` que imped铆a la carga de los datos del formulario.
    *   **Causa Ra铆z:** Exist铆a una discrepancia en la estructura del JSON esperado por el frontend y el JSON devuelto por el backend. La funci贸n `handleGetDropdownData` devolv铆a los datos bajo una clave `data` con nombres de campo en plural (ej. `categorias`), mientras que el frontend esperaba una clave `dropdowns` con nombres en singular (ej. `categoria`).
    *   **Soluci贸n:** Se modific贸 la estructura del objeto de respuesta en `handleGetDropdownData` para que coincida exactamente con la esperada por el frontend, resolviendo el `TypeError`.
    *   **Archivos Modificados:** `services/catalog/catalog.js`: L铆neas 286-298.

**v4.3.9 (31-12-2025)**
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `GPSpedia-Catalog` a la nueva versi贸n desplegada, asegurando que el frontend se comunique con el endpoint m谩s reciente y corregido.
    *   **Archivos Modificados:** `api-manager.js`: L铆nea 11.

**v4.3.8 (31-12-2025)**
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `GPSpedia-Write` a la nueva versi贸n desplegada, asegurando que el frontend se comunique con el endpoint m谩s reciente para las operaciones de escritura.
    *   **Archivos Modificados:** `api-manager.js`: L铆nea 12.

**v4.3.7 (31-12-2025)**
*   **HOTFIX (services/catalog/catalog.js):** Se solucion贸 un error cr铆tico que imped铆a la carga de los datos del formulario en `add_cortes.html`.
    *   **Causa Ra铆z:** Se produc铆a un error de `TypeError: ... .getValues is not a function` en la funci贸n `handleGetDropdownData`. El c贸digo intentaba llamar a `.getValues()` sobre un array simple devuelto por `getCriteriaValues()`, lo cual es incorrecto.
    *   **Soluci贸n:** Se elimin贸 la llamada err贸nea a `.getValues()`, permitiendo que el array de valores de la lista de validaci贸n de datos se procese correctamente.
    *   **Archivos Modificados:** `services/catalog/catalog.js`: L铆nea 290.

**v4.3.6 (31-12-2025)**
*   **HOTFIX (index.html):** Se solucion贸 la causa ra铆z de la regresi贸n cr铆tica que imped铆a la carga del cat谩logo.
    *   **Causa Ra铆z:** Un error de `ReferenceError: crearCarrusel is not defined` deten铆a la ejecuci贸n de todo el JavaScript. La funci贸n `crearCarrusel` fue definida dentro del scope de `mostrarCategorias`, pero era llamada por `mostrarUltimosAgregados`, que se ejecutaba antes.
    *   **Soluci贸n:** Se movi贸 la definici贸n de la funci贸n `crearCarrusel` al 谩mbito global del script. Esto asegura que la funci贸n est茅 definida antes de cualquier llamada, resolviendo el error de referencia y permitiendo que la aplicaci贸n se inicialice correctamente.
    *   **Archivos Modificados:** `index.html`: L铆neas 1699-1773, 2635-2709.

**v4.3.5 (31-12-2025)**
*   **HOTFIX (service-worker.js):** Se solucion贸 una regresi贸n cr铆tica introducida en la v4.3.4 que imped铆a la carga del cat谩logo y causaba la p茅rdida de sesi贸n en cada recarga.
    *   **Causa Ra铆z:** El commit anterior introdujo cambios significativos en el frontend (`index.html`) pero no increment贸 la versi贸n de la cach茅 en el service worker. Esto provoc贸 que los clientes siguieran usando una versi贸n de JavaScript en cach茅, incompatible con la nueva l贸gica, causando un error fatal durante la inicializaci贸n.
    *   **Soluci贸n:** Se increment贸 la versi贸n de la cach茅 de `v4` a `v5` en `service-worker.js`. Esto invalida la cach茅 obsoleta y fuerza a todos los clientes a descargar la 煤ltima versi贸n de la aplicaci贸n, restaurando la funcionalidad completa.
    *   **Archivos Modificados:** `service-worker.js`: L铆nea 1.

**v4.3.4 (31-12-2025)**
*   **UX (index.html):** Se implementaron m煤ltiples mejoras en la interfaz de usuario para aumentar la compacidad y corregir funcionalidades.
    
    *   **Logo en Modal:** Se corrigi贸 la l贸gica de `mostrarDetalleModal` para asegurar que el logo de la marca siempre se cargue y muestre. 

    *   **Carruseles:** Se refactoriz贸 la l贸gica de navegaci贸n, generaliz谩ndola en la funci贸n `crearCarrusel` para que todos los carruseles (ltimos Agregados, Categor铆as, Marcas) tengan botones de navegaci贸n funcionales.

    *  **Botones de Feedback:** Se redujo el tama帽o de los botones "til" y "Reportar" en un 10% mediante CSS.

NOTA SIBRE ESTA ENTEADA, algunos cambios solicitados no se realizaron y se ignoraron instrucciones. 
    *   **Archivos Modificados:** `index.html`: L铆neas 814-855, 1282-1288, 1983-2225, 2561-2835, 3331-3351.

**v4.3.3 (31-12-2025)**
*   **REFACTOR & FIX (index.html):** Se ha redise帽ado por completo el modal de detalles del veh铆culo para alinearlo con la nueva especificaci贸n de 12 puntos y corregir m煤ltiples regresiones cr铆ticas.
    *   **Especificaci贸n del Modal:**
        1.  **Restaurada Navegaci贸n Principal:** Se corrigi贸 la funci贸n `mostrarCategorias` para renderizar correctamente los carruseles de Categor铆as y Marcas.
        2.  **Reparado Video en Tutoriales:** Se corrigi贸 la funci贸n `mostrarDetalleTutorial` para usar `item.Video` en lugar de `item.videoGuia`, restaurando la visualizaci贸n de videos.
        3.  **Reparada Imagen en Relay:** Se corrigi贸 la funci贸n `mostrarDetalleRelay` para usar la variable de contenedor correcta, restaurando la visualizaci贸n de im谩genes.
        4.  **Nuevo Encabezado Detallado:** El encabezado del modal ahora muestra el T铆tulo, Logo de Marca, Versi贸n, Rango de A帽os y Categor铆a en el formato especificado.
        5.  **Orden de Contenido:** El cuerpo del modal ahora sigue el orden estricto: Corte Recomendado, Otros Cortes (acorde贸n), Apertura (acorde贸n), Alimentaci贸n (acorde贸n) y Video Gu铆a (acorde贸n).
        6.  **Corte Recomendado Fijo:** La secci贸n del corte con m谩s "likes" siempre est谩 visible y expandida.
        7.  **Estilo de Imagen de Veh铆culo:** La imagen principal del veh铆culo ahora tiene una altura m谩xima de 150px y un efecto `drop-shadow`.
        8.  **Estilo de Imagen de Corte Recomendado:** La imagen dentro del corte recomendado ahora ocupa el 100% del ancho del panel.
        9.  **Posici贸n del Link de Relay:** El enlace "Ver Configuraci贸n de Relay" ahora aparece correctamente *antes* del nombre del colaborador.
        10. **Alineaci贸n del Colaborador:** El nombre del colaborador ahora se alinea a la izquierda.
        11. **Emoji en Nota Importante:** Se a帽adi贸 el emoji `锔` a la nota importante.
        12. **Eliminaci贸n de Notas Personales:** La secci贸n de notas personales fue eliminada por completo.
    *   **Archivos Modificados:**
        *   `index.html`: L铆neas 1714-1888, 2125-2405.

**v4.3.2 (31-12-2025)**
*   **INFRA (api-manager.js):** Se actualizaron las URLs de los microservicios `CATALOG` y `FEEDBACK` a las nuevas versiones desplegadas, asegurando la comunicaci贸n con los endpoints correctos.
    *   `api-manager.js`: L铆neas 10-14

**v4.3.1 (31-12-2025)**
*   **REFACTOR (services/feedback/feedback.js):** Se mejor贸 y robusteci贸 la l贸gica de `handleSuggestYear`. La funci贸n ahora solo considera votos de usuarios 煤nicos para aplicar un cambio en el rango de a帽os, preveniendo que un solo usuario fuerce una actualizaci贸n. Adicionalmente, se corrigi贸 el `MimeType` de la respuesta del servicio a `TEXT` para garantizar la compatibilidad con CORS y prevenir errores de `Failed to fetch`. Se elimin贸 tambi茅n una declaraci贸n duplicada de la funci贸n `handleRecordLike`.
    *   `services/feedback/feedback.js`: L铆neas 128-140, 210-218
*   **FIX (index.html):** Se corrigi贸 un bug cr铆tico en la funci贸n `handleLike` que imped铆a el correcto funcionamiento del feedback de usuario y la sugerencia de a帽os. La nueva implementaci贸n asegura que la UI se actualice correctamente, previene env铆os duplicados y pasa el `userId` requerido al backend.
    *   `index.html`: L铆neas 3200-3250
*   **REFACTOR (services/catalog/catalog.js):** Se extendi贸 la funcionalidad de conversi贸n de thumbnails. La funci贸n `convertirAGoogleThumbnail` ahora se aplica tambi茅n a los datos de las secciones "Tutoriales" y "Relay", centralizando completamente la l贸gica de formateo de im谩genes en el backend.
    *   `services/catalog/catalog.js`: L铆neas 240-258

**v4.3.0 (15/01/2026)**
*   **FIX CRTICO (index.html, catalog.js, utilities.js):** Se solucion贸 la causa ra铆z final y persistente del fallo de renderizaci贸n de im谩genes de Google Drive en todo el sistema.
    *   **Causa Ra铆z:** Las funciones auxiliares que convert铆an URLs de Google Drive a formatos de thumbnail (`convertirAGoogleThumbnail` en el frontend y backend, y `getImageCreationDate` en utilities) utilizaban una expresi贸n regular que no era capaz de parsear todos los formatos de URL existentes en la base de datos (ej. URLs con `/view` o `/file/d/`).
    *   **Soluci贸n:** Se refactorizaron todas las instancias de esta l贸gica con una expresi贸n regular mucho m谩s robusta que ahora captura correctamente el ID del archivo desde m煤ltiples formatos de URL (`.../file/d/ID...`, `...id=ID...`, y `.../d/ID...`). Esto asegura una conversi贸n de URLs consistente y correcta en toda la aplicaci贸n.
        *   `index.html`: L铆neas 1943-1961
        *   `services/catalog/catalog.js`: L铆neas 346-362
        *   `services/utilities/utilities.js`: L铆neas 127-145, 192-210

**v4.2.9 (14/01/2026)**
*   **FIX (index.html):** Se solucion贸 un bug visual cr铆tico que imped铆a la renderizaci贸n de los logos de las marcas en la vista de selecci贸n de marcas.
    *   **Causa Ra铆z:** La funci贸n `mostrarMarcas` asignaba directamente la URL de Google Drive (`logoUrl`) al atributo `src` de la imagen, sin convertirla al formato de thumbnail requerido por el navegador para su correcta visualizaci贸n.
    *   **Soluci贸n:** Se envolvi贸 la variable `logoUrl` dentro de la funci贸n auxiliar `convertirAGoogleThumbnail` antes de asignarla al `src`. Esto asegura que la URL se formatee correctamente y que la imagen del logo se renderice como es debido. (L铆nea 2567).

**v4.2.8 (13/01/2026)**
*   **FIX (index.html):** Se solucion贸 la causa ra铆z del fallo en la renderizaci贸n de logos de marcas.
    *   **Causa Ra铆z:** La l贸gica anterior para encontrar logos (`getLogoUrlForMarca`) era demasiado r铆gida y se basaba en la concatenaci贸n de strings (ej. 'marca' + 'motocicletas'), lo que no coincid铆a con los nombres reales en la base de datos (ej. 'Honda Motocicletas').
    *   **Soluci贸n:** Se revirti贸 el fallback a texto y se refactoriz贸 `getLogoUrlForMarca` con un algoritmo de b煤squeda flexible. La nueva funci贸n normaliza los nombres, busca todas las coincidencias parciales que contienen el nombre de la marca y luego usa la categor铆a para desambiguar de forma inteligente entre variantes (ej. prioriza "motocicletas" si la categor铆a es "Motos"). Esto asegura que el logo correcto se encuentre siempre. (L铆neas 1901-1941, 2535-2565).
*   **FEAT (index.html):** Se implement贸 la l贸gica de frontend para la sugerencia de a帽o, completando el flujo de feedback del usuario.
    *   **Funcionalidad:** Despu茅s de que un usuario presiona el bot贸n "til" para registrar un "like", ahora se le presenta un `prompt` que le pregunta si el corte aplica a otro a帽o.
    *   **Implementaci贸n:** Si el usuario ingresa un a帽o v谩lido, la funci贸n `handleLike` invoca la acci贸n `suggestYear` en el backend para registrar la sugerencia. Se a帽adi贸 manejo de errores y validaci贸n de entrada para asegurar que solo se env铆en a帽os num茅ricos v谩lidos. (L铆neas 2933-2980).

**v4.2.7 (12/01/2026)**
*   **FIX (index.html):** Se implement贸 un mecanismo de fallback para la visualizaci贸n de marcas. Si los datos de los logos no est谩n disponibles en el backend (la variable `datosLogos` est谩 vac铆a), la funci贸n `mostrarMarcas` ahora renderizar谩 tarjetas de solo texto con los nombres de las marcas en lugar de mostrar im谩genes rotas. Esto asegura que la navegaci贸n siga siendo funcional y la experiencia de usuario sea fluida incluso con datos incompletos. (L铆neas 2535-2588).

**v4.2.6 (11/01/2026)**
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `CATALOG` a la nueva versi贸n desplegada proporcionada por el usuario. (L铆nea 10).

**v4.2.5 (10/01/2026)**
*   **FIX (index.html & services/catalog/catalog.js):** Se implement贸 una soluci贸n integral para el fallo persistente en la renderizaci贸n de logos de marcas.
    1.  **Backend (`services/catalog/catalog.js`):** Se corrigi贸 una inconsistencia cr铆tica en la funci贸n `doGet`. Se actualiz贸 el n煤mero de versi贸n reportado de `1.2.1` a `2.3.0` y se a帽adi贸 `LogosMarca` a la lista de hojas de c谩lculo accedidas en el modo debug. Esto asegura que la metadata del servicio refleje su funcionalidad real. (L铆neas 77, 79).
    2.  **Frontend (`index.html`):** Se robusteci贸 la funci贸n `mostrarMarcas`. Ahora incluye una comprobaci贸n defensiva que emite un `debugLog` si `datosLogos` est谩 vac铆o, alertando sobre problemas de datos. Adem谩s, se a帽adi贸 un manejador de eventos `onerror` a las im谩genes de los logos, que muestra una imagen de "Error" y registra un `debugLog` si la carga falla. (L铆neas 2535-2565).
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `FEEDBACK` a la nueva versi贸n desplegada y proporcionada por el usuario, restaurando la funcionalidad del sistema de Inbox y reportes. (L铆nea 12).

**v4.2.4 (09/01/2026)**
*   **FIX CRTICO (index.html):** Se solucion贸 una regresi贸n cr铆tica que imped铆a la carga del cat谩logo y causaba la p茅rdida de sesi贸n en cada recarga.
    *   **Causa Ra铆z:** Un error de `ReferenceError: updateCarousel is not defined` deten铆a la ejecuci贸n de JavaScript. La funci贸n `updateCarousel` se defin铆a dentro de un bloque `if` en la l贸gica del carrusel, pero era llamada por un `setTimeout` que se encontraba fuera de dicho bloque. Si la condici贸n del `if` no se cumpl铆a (p.ej., si hab铆a menos de 6 elementos en el carrusel), la funci贸n no se declaraba, provocando el error fatal.
    *   **Soluci贸n:** Se movi贸 la llamada `setTimeout(updateCarousel, 100)` dentro del bloque `if` para asegurar que solo se ejecute si la funci贸n `updateCarousel` ha sido definida. Esto previene el error y permite que la aplicaci贸n se inicialice correctamente. (L铆nea 2525).

**v4.2.3 (08/01/2026)**
*   **FIX (index.html):** Se corrigi贸 una regresi贸n cr铆tica introducida en la v4.2.0 que romp铆a la funcionalidad de la barra de b煤squeda.
    *   **Causa Ra铆z:** La funci贸n `mostrarResultadosBusquedaMarca` intentaba obtener la URL del logo de la marca usando `estado.categoria`, que es nulo o incorrecto en el contexto de una b煤squeda global. Esto provocaba un fallo en la renderizaci贸n de los resultados.
    *   **Soluci贸n:** Se modific贸 la llamada a `getLogoUrlForMarca` para pasar `null` como categor铆a, forzando a la funci贸n a usar su l贸gica de fallback para encontrar el logo gen茅rico de la marca, restaurando as铆 la funcionalidad. (L铆nea 2282).

**v4.2.2 (08/01/2026)**
*   **INFRA (api-manager.js):** Se actualizaron las URLs de los microservicios `CATALOG` y `UTILITIES` a las newas versiones desplegadas y proporcionadas por el usuario, asegurando que el frontend se comunique con los endpoints m谩s recientes. (L铆neas 10, 14).

**v4.2.1 (07/01/2026)**
*   **FIX (catalog.js & index.html):** Se corrigi贸 un bug funcional en el ordenamiento de categor铆as. La versi贸n anterior calculaba la popularidad pero no la aplicaba.
    1.  **Backend (`services/catalog/catalog.js`):** Se a帽adi贸 la l贸gica para ordenar la lista de categor铆as por `vehicleCount` (descendente) antes de enviarla al frontend. (L铆neas 220-221).
    2.  **Frontend (`index.html`):** Se elimin贸 el ordenamiento alfab茅tico (`.sort()`) que se aplicaba en el cliente, asegurando que el orden del backend sea respetado. Se modific贸 la funci贸n `mostrarCategorias` para usar la nueva lista `sortedCategoriesList` recibida. (L铆neas 1611, 1458, 2326-2332).
*   **FEAT (services/utilities/utilities.js):** Se a帽adi贸 una nueva funcionalidad al servicio de utilidades para obtener la fecha de creaci贸n de una imagen a partir de su URL de Google Drive.
    1.  **Helper Function:** Se cre贸 una nueva funci贸n auxiliar `getImageCreationDate(url)` que extrae el ID del archivo de la URL, accede al archivo mediante `DriveApp` y devuelve su fecha de creaci贸n en formato ISO. (L铆neas 105-128).
    2.  **API Endpoint:** Se expuso esta funcionalidad a trav茅s de una nueva acci贸n `getImageCreationDateFromUrl` en el `doPost`, permitiendo que sea invocada de forma segura desde el frontend (requiere rol 'Desarrollador'). (L铆neas 66-72).

**v4.2.0 (06/01/2026)**
*   **FEAT (feedback.js):** Se refactoriz贸 completamente la l贸gica de `handleSuggestYear` para cumplir con los nuevos requisitos de negocio. La funci贸n ahora requiere 3 votos de usuarios para aplicar un cambio y ejecuta una comprobaci贸n anti-colisi贸n para prevenir el solapamiento de rangos de a帽os entre diferentes generaciones de un mismo modelo.
*   **REFACTOR (catalog.js):** Se centraliz贸 la l贸gica de conversi贸n de URLs de Google Drive a thumbnails en el backend. La nueva funci贸n `convertirAGoogleThumbnail` ahora procesa todas las URLs de im谩genes antes de enviarlas al frontend, mejorando el rendimiento y la consistencia.
*   **UX (index.html):** Se implementaron m煤ltiples mejoras en la interfaz de usuario:
    *   **Layout Principal:** Se reorganiz贸 la p谩gina principal para mostrar primero la secci贸n "ltimos Agregados" y luego las "Categor铆as".
    *   **Carrusel:** La secci贸n "ltimos Agregados" es ahora un carrusel que muestra 6 tarjetas.
    *   **Navegaci贸n por Marca:** La vista de selecci贸n de marca ahora muestra los logos en lugar de texto.
    *   **Modal de Detalles:** Se unific贸 la funcionalidad de "like" y "sugerir a帽o" en el bot贸n "til" (). Se a帽adieron placeholders de edici贸n "in-modal" para campos sin datos.
*   **CHORE:** Las modificaciones se realizaron de forma segura, sin alterar la l贸gica cr铆tica protegida de `auth.js` (sesiones) ni `catalog.js` (carga de datos y cach茅).

**v4.1.1 (05/01/2026)**
*   **FIX (index.html):** Se restaur贸 la l贸gica para el bot贸n de instalaci贸n de la PWA (`beforeinstallprompt` listener y el handler del click), que fue eliminada accidentalmente en una refactorizaci贸n previa. Esto soluciona una regresi贸n cr铆tica que imped铆a a los usuarios instalar la aplicaci贸n. (L铆neas 2315-2346).
*   **INFRA (api-manager.js):** Se actualiz贸 la URL del microservicio `GPSpedia-Utilities` a la nueva versi贸n desplegada y funcional, eliminando el endpoint placeholder. (L铆nea 14).

**v4.1.0 (04/01/2026)**
*   **FEAT (services/utilities/utilities.js & index.html):** Se implement贸 un nuevo microservicio `GPSpedia-Utilities` y la interfaz de frontend correspondiente para herramientas de administrador.
    1.  **Backend (`services/utilities/utilities.js`):** Creado el nuevo servicio con acciones protegidas (`migrateYearRanges`, `migrateTimestamps`) para migraciones de datos. (Archivo nuevo).
    2.  **Frontend (`index.html`):** A帽adido un modal "Herramientas de Desarrollador", accesible mediante un nuevo bot贸n en el men煤 lateral (visible solo para rol 'Desarrollador'). El modal incluye botones para ejecutar las migraciones y muestra la consola de depuraci贸n. (L铆neas 923-950, 2593-2625, 2772-2808).
    3.  **Infra (`api-manager.js`):** Registrado el nuevo endpoint `UTILITIES` y mapeadas las nuevas acciones. (L铆neas 14, 46-47).
*   **FEAT (services/feedback/feedback.js & index.html):** Se implement贸 un sistema de "Inbox" para la gesti贸n de feedback de usuarios.
    1.  **Backend (`services/feedback/feedback.js`):** A帽adidas nuevas acciones (`getFeedbackItems`, `replyToFeedback`, `markAsResolved`) para leer y gestionar los reportes de problemas y mensajes de contacto. (L铆neas 114-123, 342-423).
    2.  **Frontend (`index.html`):** A帽adido un modal de "Inbox", accesible mediante un nuevo bot贸n en el men煤 lateral (visible para roles 'Supervisor', 'Gefe', 'Desarrollador'). La UI permite ver, responder y resolver items de feedback. (L铆neas 907-921, 2582-2591, 2665-2770).
*   **FIX (users.html):** Solucionado un bug cr铆tico que causaba que los datos de los usuarios se mostrasen como "undefined" en la tabla de gesti贸n y en el modal de edici贸n. El problema se deb铆a a un desfase de may煤sculas y min煤sculas (`camelCase` en el frontend vs. `PascalCase_With_Underscores` en el backend). Se corrigi贸 el acceso a las propiedades en todo el archivo. (L铆neas 239-241, 273-279, 318-322, 339, 349-354).
*   **UX (index.html):** Se implementaron mejoras en la interfaz de usuario del modal de detalles del veh铆culo.
    1.  **Botones de Feedback:** Se redise帽aron los botones "til" y "Reportar" para que sean m谩s compactos, mostrando un 铆cono y texto sin un contenedor de bot贸n grande. (L铆neas 1769-1782).
    2.  **Video Gu铆a:** La secci贸n "Video Gu铆a de Desarme" ahora se muestra dentro de un acorde贸n colapsable, igual que el resto de la informaci贸n suplementaria. (L铆neas 1844-1853).
*   **CHORE:** No se introdujeron regresiones en las funcionalidades estables (login, sesi贸n, carga de cat谩logo, cach茅).

**v4.0.2 (03/01/2026)**
*   **DOCS (Auditoria.txt & README.md):** Se realiz贸 una auditor铆a completa del sistema y se sincroniz贸 la documentaci贸n para reflejar el estado real del c贸digo.
    1.  **Auditor铆a (`Auditoria.txt`):** Se sobrescribi贸 el archivo con un nuevo reporte confirmando que el c贸digo fuente es funcional y no presenta los bugs cr铆ticos listados en la documentaci贸n. Se identific贸 el `README.md` como la fuente de la inconsistencia.
    2.  **Sincronizaci贸n (`README.md`):** Se actualizaron los checklists en la secci贸n "Bugs y Regresiones Cr铆ticas" para marcar como completados `[X]` los siguientes puntos, que ya estaban resueltos en el c贸digo: "L贸gica del Modal de Detalle", "Carga de Im谩genes en Modal" y "Carga de Logos en Modal". (L铆neas 231-233).

**v4.0.1 (02/01/2026)**
*   **FIX CRTICO (api-manager.js & services/catalog/catalog.js):** Solucionado un error de "Fallo de conexi贸n" (Failed to fetch) con el servicio de cat谩logo. El fix integral incluy贸:
    1.  **Backend (`services/catalog/catalog.js`):** Se cambi贸 el `MimeType` de la respuesta de `JSON` a `TEXT` para cumplir con la pol铆tica de CORS del entorno de Google Apps Script. (L铆neas 112, 124).
    2.  **Frontend (`api-manager.js`):** Se actualiz贸 la l贸gica de `routeAction` para procesar la respuesta como texto (`.text()`) y luego parsearla (`JSON.parse()`), en lugar de usar directamente `.json()`. (L铆neas 83-84).
*   **INFRA (api-manager.js):** Se ha actualizado la URL del microservicio `GPSpedia-Catalog` a la nueva versi贸n desplegada proporcionada por el usuario. (L铆nea 12).
*   **FIX (index.html):** Se corrigi贸 la l贸gica del modal de detalles (`mostrarDetalleModal`). Ahora, el corte recomendado se muestra de forma visible por defecto, mientras que los cortes adicionales se presentan en secciones desplegables (acorde贸n), cumpliendo con los requisitos de la auditor铆a. (L铆neas 1709-1811).
*   **FIX (index.html):** Solucionado un bug que imped铆a la visualizaci贸n de im谩genes suplementarias en el modal de detalles. Se a帽adi贸 la l贸gica para renderizar las im谩genes de apertura, cable de alimentaci贸n y diagramas de relay en sus correspondientes secciones. (L铆neas 1750-1768, 1829-1875).

**v4.0.0 (02/01/2026)**
*   **FIX CRTICO (services/catalog/catalog.js):** Se ha solucionado el error `cannot read properties of undefined (reading 'categoria')` que imped铆a la carga de datos del cat谩logo y de los formularios. Se implement贸 la funci贸n `mapRowToObject` que faltaba y se corrigi贸 `handleGetDropdownData` para leer din谩micamente las opciones de "Categor铆a" desde las reglas de validaci贸n de la hoja de c谩lculo.
*   **FIX CRTICO (services/users/users.js):** Se ha reparado el servicio de gesti贸n de usuarios, que fallaba en todas sus operaciones (`Failed to fetch`). El error se deb铆a a que la funci贸n `doPost` no retornaba ninguna respuesta. Se corrigi贸 la funci贸n para asegurar que todas las acciones devuelvan un resultado al frontend.
*   **REFACTOR & FEAT (index.html):** Se ha eliminado la p谩gina `info.html` y su contenido se ha integrado directamente en `index.html` como modales.
    *   Las secciones "Sobre Nosotros", "Cont谩ctanos" y "Preguntas Frecuentes" ahora se abren como pop-ups sin necesidad de recargar la p谩gina.
    *   Se ha a帽adido el nuevo contenido extendido a estas secciones.
    *   Se a帽adi贸 un peque帽o margen al CSS del pie de p谩gina para mejorar la separaci贸n visual de los enlaces.
*   **FIX (index.html):** Se ha corregido el env铆o del formulario de contacto, que fallaba por un error tipogr谩fico en el nombre de la acci贸n (`sendContacForm` -> `sendContactForm`).
*   **CHORE (project):** Se han actualizado los n煤meros de versi贸n en todos los archivos modificados a `4.0.0` (global) y a las versiones de componente correspondientes.
