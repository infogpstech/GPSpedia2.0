# Registro de Cambios del Proyecto GPSpedia

## v4.0.0 - 21/12/2023
- **MIGRACIÓN COMPLETA A ARQUITECTURA MODULAR (PLAN B):**
  - **Refactorización del Backend:** Se desmanteló el script monolítico `Code.gs` y se migró toda la lógica de negocio a cinco (5) microservicios independientes en Google Apps Script: `Auth`, `Catalog`, `Write`, `Users` y `Feedback`.
  - **Refactorización del Frontend:** Se introdujo `api-manager.js`, un nuevo módulo que actúa como un enrutador central para todas las llamadas a la API, dirigiendo las solicitudes al microservicio correcto. Todos los archivos HTML (`index.html`, `add_cortes.html`, `users.html`) fueron actualizados para utilizar este nuevo sistema.
  - **Problema Persistente con Autenticación:** Durante la migración, surgió un bug crítico y persistente en el servicio `Auth.js` que impedía el inicio de sesión ("Credenciales inválidas"). El error resistió múltiples intentos de corrección, incluyendo la mejora de la comparación de contraseñas y la implementación de un sistema de logging avanzado en Google Sheets.
  - **RESOLUCIÓN DEFINITIVA:** Tras un exhaustivo proceso de depuración, se tomó la decisión de reconstruir el servicio `Auth.js` desde cero, basándose en las especificaciones directas del usuario. La solución final eliminó la lógica dinámica de mapeo de columnas (la causa raíz de los fallos) y la reemplazó con una estructura de columnas hardcoded, simple y robusta. Esta acción resolvió el problema de forma definitiva.
- **Actualización de Documentación:** Se actualizó `README.md` y `INSTRUCCIONES_DESPLIEGUE.md` para reflejar la nueva arquitectura y los procedimientos.

## v3.009 - 23/07/2024
- **Plan B:** Se inicia la implementación del Plan B para resolver de forma definitiva el error "Credenciales inválidas".
- **Análisis de Causa Raíz:** Se confirma que el error de "Credenciales inválidas" persiste debido a un fallo de lógica en el manejo de la contraseña en el frontend, y no es un problema de despliegue del AppsScript. La función `sanitizeInput` sigue alterando la contraseña antes de ser enviada.
- **Próximos Pasos:** Se procederá a eliminar por completo la sanitización del campo de contraseña en `index.html`.

## v3.008 - 23/07/2024
- Se actualizó la `SCRIPT_URL` en los archivos `index.html`, `users.html` y `add_cortes.html` a la nueva URL de despliegue proporcionada por el usuario.

## v3.007 - 22/07/2024
- Se corrigió el error "Credenciales inválidas" al iniciar sesión.
- Se eliminó la función `sanitizeInput` del frontend (`index.html`) que modificaba incorrectamente las contraseñas con caracteres especiales.
- Se mejoró la comparación de contraseñas en el backend (`Code.gs`) para que sea estrictamente de texto.
- Se actualizó la URL del script en `index.html`, `users.html` y `add_cortes.html`.
- Se agregó un número de versión visible en la pantalla de inicio de sesión para facilitar la depuración.
- Se creó el archivo `INSTRUCCIONES_DESPLIEGE.md` para guiar al usuario en el proceso de despliegue correcto.

## v3.006 - 21/07/2024
- Se implementó una solución en el backend (Code.gs) para forzar la comparación de contraseñas como texto, evitando errores cuando la contraseña es puramente numérica.

## v3.005 - 20/07/2024
- Se actualizó el número de versión en Code.gs para reflejar los cambios recientes.

## v3.004 - 19/07/2024
- Se corrigió la función `sanitizeInput` en `index.html` para evitar que altere las contraseñas que contienen caracteres especiales. El error anterior causaba el fallo de "Credenciales inválidas".

## v3.003 - 18/07/2024
- Se cambió el `Content-Type` en las solicitudes `fetch` de `application/json` a `text/plain` en los archivos `index.html`, `add_cortes.html` y `users.html` para solucionar el error "Fail to fetch" relacionado con CORS.

## v3.002 - 17/07/2024
- Se agregó el manejo de errores detallado en la función `postToAction` para capturar y mostrar problemas de red o de análisis JSON.
- Se implementó un sistema de logging remoto (`remoteLog`) para enviar errores del frontend al backend y facilitar la depuración.

## v3.001 - 16/07/2024
- Se identificó que el error "Fail to fetch" es probablemente un problema de CORS (Cross-Origin Resource Sharing) que ocurre durante la solicitud de pre-vuelo (preflight request) OPTIONS que el navegador envía antes de la solicitud POST real.
